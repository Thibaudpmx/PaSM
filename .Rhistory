scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
allTimes
allTimes %>%
gather(GreenFilter, RedFilter)
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_less_usable_param")
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
allTimes
allTimes %>%
gather("param", "value", GreenFilter, RedFilter)
allTimes %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_bar(aes(x = labelx, y =value, fill = param))
allTimes %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_bar(aes(x = labelx, y = value, fill = param))
allTimes %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_bar(aes(x = labelx, y = value, fill = param), position = "nudge")
allTimes %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "nudge")
allTimes
allTimes %>%
filter(pct == 0) %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "nudge")
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "nudge")
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "dodge")
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "dodge")+
theme_bw()
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "dodge")+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red"))
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "dodge")+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "dodge")+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), position = "dodge")+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.3)+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = value))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)),position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)),position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot()+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)),position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)),position_dodge2(preserve = "single", width = .9))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
# geom_text(aes(x = labelx, y = value, label = round(value)),position_dodge2(preserve = "single", width = .9))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)),position_dodge(preserve = "single", width = .9))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)), , position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)), , position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value)),  position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value), gruop = param),  position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value), group = param),  position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_less_usable_param")
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value), group = param),  position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
library(QSPVP)
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
#  plot A - making: Simeoni analysis -----------------------------------------------
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_no_green")
allTimes <- readRDS("full_analysis.RDS") #%>%
readRDS("timeReference.RDS") %>%
as.data.frame() %>%
mutate(time = time * 10E-10) %>%
summarise(min = min(time), max = max(time), median = median(time)) -> ref
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
allTimes
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)
allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)
allTimes
setwd("D:/these/Second_project/Q
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_less_usable_param")
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_less_usable_param")
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value), group = param),  position = position_dodge2(preserve = "single", width = .9, padding = 0.1))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = round(value), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),0), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
#  plot A - making: Simeoni analysis -----------------------------------------------
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_no_green")
allTimes <- readRDS("full_analysis.RDS") #%>%
readRDS("timeReference.RDS") %>%
as.data.frame() %>%
mutate(time = time * 10E-10) %>%
summarise(min = min(time), max = max(time), median = median(time)) -> ref
allTimes %>%
mutate(pcteffe = VPfound / 200000) %>%
filter(pct != pcteffe) # note: 1 or 2 of differences can be explained by internal rounding
allTimesWith_green <- readRDS("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni/full_analysis.RDS") %>%
mutate(pct = as.double(pct)) %>%
mutate(nparam = as.character(nparam)) %>%
mutate(meth = if_else(meth == "", "Centered", "Lowest")) %>%
group_by(nparam, pct, meth) %>%
summarise(timeTotal = median(timeTotal)) %>%
ungroup() %>%
rename(Yes = timeTotal)
plotA <- allTimes %>%
mutate(pct = as.double(pct)) %>%
mutate(nparam = as.character(nparam)) %>%
mutate(meth = if_else(meth == "", "Centered", "Lowest")) %>%
group_by(nparam, pct, meth) %>%
summarise(timeTotal = median(timeTotal)) %>%
ungroup() %>%
ggplot()+
# geom_rect(aes(xmin = 48, xmax = 52, ymin = 39, ymax = 41.5), col = "red",alpha = 0)+
# geom_segment(aes(x = 56, xend = 52, y = 45, yend = 42), col = "red",  arrow = arrow(length = unit(0.2, "cm")))+
# geom_text(aes(x = 62, y = 46, label = "next plots"), col = "red", size = 3)+ # Note: last 3 brut way, not reproducible
geom_point(aes(x = (1-pct) * 100, y = timeTotal, col = nparam))+
geom_line(aes(x = (1-pct)* 100, y = timeTotal, col = nparam, lty = meth))+
geom_line(data = allTimesWith_green , aes(x = (1-pct)* 100, y =  Yes, col = nparam, lty = meth), alpha = 0.5)+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
theme_bw()+
scale_linetype_manual(values = c(1,2))+
scale_fill_manual(values = "grey")+
labs(x = "Percentage of rejected VP", y = "Total Time analysis (sec)", col = "Number\nvarying\nparameters", fill = "",
lty = "Target\nmethod"); plotA
plotB <- allTimes %>%
mutate(pct = as.double(pct)) %>%
mutate(nparam = as.character(nparam)) %>%
mutate(meth = if_else(meth == "", "Centered", "Lowest")) %>%
group_by(nparam, pct, meth) %>%
summarise(timeTotal = median(timeTotal)) %>%
ungroup() %>%
rename(No = timeTotal) %>%
left_join(allTimesWith_green  ) %>%
mutate(dif = No - Yes) %>%
ggplot()+
# geom_rect(aes(xmin = 48, xmax = 52, ymin = 39, ymax = 41.5), col = "red",alpha = 0)+
# geom_segment(aes(x = 56, xend = 52, y = 45, yend = 42), col = "red",  arrow = arrow(length = unit(0.2, "cm")))+
# geom_text(aes(x = 62, y = 46, label = "next plots"), col = "red", size = 3)+ # Note: last 3 brut way, not reproducible
geom_point(aes(x = (1-pct) * 100, y = dif, col = nparam))+
geom_line(aes(x = (1-pct)* 100, y = dif, col = nparam, lty = meth))+
theme_bw()+
scale_linetype_manual(values = c(1,2))+
scale_fill_manual(values = "grey")+
labs(x = "Percentage of rejected VP", y = "Total Time analysis (sec)", col = "Number\nvarying\nparameters", fill = "",
lty = "Target\nmethod"); plotB
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
setwd("D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/data/Simeoni_less_usable_param")
allTimes <- readRDS("full_analysis.RDS") %>%
mutate(labelx = paste0( 5- nparam, "/5")) %>%
mutate(GreenFilterlab = if_else(pct == 0, "Without", "With"))
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),0), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
allTimes
allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),"s"), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))
plotC <- allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),"s"), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue")); plotC
cowplot::plot_grid(plotA, plotB)
cowplot::plot_grid(plotA, plotB, plotC, nrow = 1, labels = LETTERS)
plotC <- allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),"s"), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))+
labs(x = "Number of parameters with monotonicity", y = "Time for each step (s)", fill = "Step"); plotC
cowplot::plot_grid(plotA, plotB, plotC, nrow = 1, labels = LETTERS)
plotC <- allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),"s"), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))+
labs(x = "Number of parameters with monotonicity", y = "Cumulative time for each step (s)", fill = "Step"); plotC
cowplot::plot_grid(plotA, plotB, plotC, nrow = 1, labels = LETTERS)
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "");plotB
plotB <- allTimes %>%
ggplot()+
geom_line(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_point(aes(x = 5-nparam, y = timeTotal, col =   GreenFilterlab))+
geom_hline(data = ref, aes(yintercept = min), lty = 1)+
geom_hline(data = ref, aes(yintercept = max), lty = 1)+
geom_rect(data = ref, aes(xmin = -Inf, xmax = Inf, ymin = min, ymax =  max, fill = "Time of\nreference"), lty = 1,alpha = 0.15)+
geom_hline(data = ref, aes(yintercept = median), lty = 2)+
scale_fill_manual(values = "grey")+
theme_bw()+
scale_x_continuous(labels = c(paste0(0:5, "/5")))+
labs( x = "Number of parameters with monotonicity ",y = "Time of analysis (s)", fill = "", col = "Green Filter");plotB
plotC <- allTimes %>%
filter(pct == 1) %>%
gather("param", "value", GreenFilter, RedFilter, RxODE) %>%
ggplot(aes(x = labelx, y = value, fill = param))+
geom_col(aes(x = labelx, y = value, fill = param), alpha = 0.5)+
geom_text(aes(x = labelx, y = value, label = paste0(round(value),"s"), group = param),       position = position_stack(vjust = .5))+
theme_bw()+
scale_fill_manual(values = c("darkgreen", "red", "blue"))+
labs(x = "Number of parameters with monotonicity", y = "Cumulative time for each step (s)", fill = "Step"); plotC
cowplot::plot_grid(plotA, plotB, plotC, nrow = 1, labels = LETTERS)
