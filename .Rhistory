scale_y_log10()
NCAres
NCAres %>%
distinct(NMID2)
NCAres %>%
distinct(NMID2) %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60)
NCAres %>%
distinct(NMID2, BOR2)
NCAres %>%
filter(YTYPE == 60) %>%
distinct(NMID2, BOR2)
NCAres %>%
filter(YTYPE == 60) %>%
distinct(NMID2, BOR2) %>%
group_by(BOR2) %>%
tally
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10() +
# theme_bw() +
facet_wrap(~key) +
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUC Tlast (copies/µL)", col = "BOR")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption = element_text(hjust=0, face = "italic"))+
# theme(plot.title = element_text(hjust = 0.5))+
scale_y_log10()
NCAres
NCAres %>%
arrange(desc(tendexpan))
NCAres %>%
filter(YTYPE == 60) %>%
arrange(desc(tendexpan))
NCAres %>%
filter(YTYPE == 60) %>%
arrange(desc(tendexpan)) %>%
select(NMID2, tendexpan)
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value", color = "BOR2",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60, BOR2 == "R") %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value", color = "BOR2",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60, BOR2 == "R") %>%
gather_(par, key = "key", value = "value" ) %>%
filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value", color = "BOR2",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60, BOR2 == "R") %>%
gather_(par, key = "key", value = "value" ) %>%
filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10() +
facet_wrap(~BOR2)
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60, BOR2 == "R") %>%
gather_(par, key = "key", value = "value" ) %>%
filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather_(par, key = "key", value = "value" ) %>%
# filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10()
NCAres
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather_(par, key = "key", value = "value" )
par
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather(AUCTlast, key = "key", value = "value" ) %>%
# filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather(AUCTlast, key = "key", value = "value" ) %>%
# filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUC Tlast (copies/µL)", col = "BOR")+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather(Cmax, key = "key", value = "value" ) %>%
# filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUC Tlast (copies/µL)", col = "BOR")+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather(AUCTlast, key = "key", value = "value" ) %>%
# filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUCTlast (days.copies/µL)", col = "BOR")+
# scale_x_log10()+
scale_y_log10()
facet_wrap(~BOR2)
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather(Cmax, key = "key", value = "value" ) %>%
# filter(value> 1) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman", facet.by = "BOR2")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
labs(x = "Tumor burden at D0", y = "UCART19 transgene Cmax (copies/µL)", col = "BOR")+
# scale_x_log10()+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10() +
# theme_bw() +
facet_wrap(~key) +
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUC Tlast (copies/µL)", col = "BOR")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption = element_text(hjust=0, face = "italic"))+
# theme(plot.title = element_text(hjust = 0.5))+
scale_y_log10()+
geom_hline(aes(yintercept = 0.1 , col = "BLQ\n(=0)"), lty = 2)
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10() +
# theme_bw() +
facet_wrap(~key) +
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUCTlast (days.copies/µL)", col = "BOR")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption = element_text(hjust=0, face = "italic"))+
# theme(plot.title = element_text(hjust = 0.5))+
scale_y_log10()
df
df %>%
filter(YTYPE == )
df %>%
filter(YTYPE == 60)
df %>%
filter(YTYPE == 60) %>%
distinct(NMID2)
df %>%
filter(YTYPE == 60)
df %>%
filter(YTYPE == 60) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV))
df %>%
filter(YTYPE == 60) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2))
df %>%
filter(YTYPE == 60) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2))+
scale_y_log10()
### retrait point post  engraftment
# Du coup la phrase ci-dessous est valable pour le patient 1, 10 et 30 (le 14 a été greffé bien plus tard). Tu confirmes ?
#and could not be assessed beyond D42-D56 in 3 pts, because residual CAR T-cells were ablated [BFI1] by the alloHSCT conditioning regimen
df %>%
filter(YTYPE == 60 & MTX !=20, NMID2 %in% c(201, 206, 210,222, 230,214), TIME_NEG_A < 300) %>%
mutate(NMID2 = paste0(NMID2, "\n", TIME_NT - 14, " days")) %>%
ggplot(aes(TIME_NEG_A - 14, DV2))+
geom_point()+
geom_line()+
facet_wrap(~NMID2)+
geom_vline(aes(xintercept = TIME_NT - 14))+
scale_y_log10()
df %>%
filter(TIME_NEG_A < TIME_NT |is.na(TIME_NT)) -> df
df
df %>%
filter(YTYPE == 60) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2))+
scale_y_log10()
df %>%
filter(BOR2 == "R")
df %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2))+
scale_y_log10()
df %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = "TBg"))+
scale_y_log10()
df %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
scale_y_log10()
df %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
facet_wrap(~NMID2)
df %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
facet_wrap(~NMID2)+
scale_y_log10()
df %>%
filter(YTYPE == 60 & MTX != 20 & TIME_NEG_A < timf)
df %>%
filter(YTYPE == 60 & MTX != 20 & TIME_NEG_A < timf) %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
# facet_wrap(~NMID2)+
scale_y_log10()
df %>%
filter(YTYPE == 60 & MTX != 20 & TIME_NEG_A < 100) %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
# facet_wrap(~NMID2)+
scale_y_log10()
df %>%
filter(YTYPE == 60 & MTX != 20 & TIME_NEG_A < 100) %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
facet_wrap(~NMID2)+
scale_y_log10()
df %>%
filter(YTYPE == 60 & MTX != 20 & TIME_NEG_A < 100) %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
# facet_wrap(~NMID2)+
scale_y_log10()
df %>%
filter(YTYPE == 60 & MTX != 20 & TIME_NEG_A < 100) %>%
filter(BOR2 == "R") %>%
filter(YTYPE == 60) %>%
mutate(TBg = if_else(TB_D0_UCART < 40, "<40", ">40")) %>%
ggplot()+
geom_line(aes(THEOTIME_UCART, DV, group = NMID2, col = TBg))+
geom_vline(xintercept = 42, lty= 2)+
# facet_wrap(~NMID2)+
scale_y_log10()
NCAres
df %>%
filter(YTYPE == 60 & MTX != 20)
df %>%
filter(YTYPE == 60 & MTX != 20) %>%
filter(THEOTIME_UCART >= 42 & DV > 0)
df %>%
filter(YTYPE == 60 & MTX != 20) %>%
filter(THEOTIME_UCART >= 42 & DV > 0) %>%
distinct(NMID2)
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
mutate(Persistant = if_else(NMID2 %in% c(201,210,214,230), "Yes", "No")) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = BOR2))+
# scale_x_log10()+
scale_y_log10() +
# theme_bw() +
facet_wrap(~key) +
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUCTlast (days.copies/µL)", col = "BOR")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption = element_text(hjust=0, face = "italic"))+
# theme(plot.title = element_text(hjust = 0.5))+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
mutate(Persistant = if_else(NMID2 %in% c(201,210,214,230), "Yes", "No")) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = Persistant))+
# scale_x_log10()+
scale_y_log10() +
# theme_bw() +
facet_wrap(~key) +
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUCTlast (days.copies/µL)", col = "BOR")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption = element_text(hjust=0, face = "italic"))+
# theme(plot.title = element_text(hjust = 0.5))+
scale_y_log10()
NCAres %>%
# distinct(YTYPE, ytype_explained)
filter(YTYPE == 60) %>%
mutate(Persistant = if_else(NMID2 %in% c(201,210,214,230), "Yes", "No")) %>%
gather_(par, key = "key", value = "value" ) %>%
mutate(value = if_else(value == 0, 0.1, value)) %>%    ## gestion 0
ggscatter( x = "TB_D0_UCART", y = "value",  add = "reg.line", cor.coef = T, cor.method = "spearman")+
geom_point(aes(x = TB_D0_UCART, y = value, col = Persistant))+
# scale_x_log10()+
scale_y_log10() +
# theme_bw() +
facet_wrap(~key) +
labs(x = "Tumor burden at D0", y = "UCART19 transgene AUCTlast (days.copies/µL)", col = "Persistance")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption = element_text(hjust=0, face = "italic"))+
# theme(plot.title = element_text(hjust = 0.5))+
scale_y_log10()
NCAres
NCAres %>%
filter(ytype_explained == "IL7")
NCAres %>%
filter(ytype_explained == "IL7") %>%
ggscatter( x = "TB_D0_UCART", y = "Cmax",  add = "reg.line", cor.coef = T, cor.method = "spearman")
cov
cov
library(QSPVP)
library(QSPVP)
library(peccary)
library(QSPVP)
library(RxODE)
library(QSPVP)
library(RxODE)
model_RxODE <-  RxODE({
d/dt(Central) <- -ke *  max(Central,0)
Conc <- Central/Vd
tumVol <- X1 + X2 + X3 + X4
growth <- lambda0 *  max(X1,0)/((1 + (lambda0 * max(tumVol,0)/lambda1)^psi)^(1/psi))
X1(0) <- w0
d/dt(X1) <- growth - X1 * max(Conc,0) * k2
d/dt(X2) <- X1 * max(Conc,0) * k2 - k1 * X2
d/dt(X3) <- k1 * (X2 - X3)
d/dt(X4) <- k1 * (X3 - X4)
})
# paremeters value to be used by default (NA if you want to force providing value)
parameters_default_values <- c(psi = 20)
# initial compartment values. At least one, and every missing cmt name would be set to 0
initial_cmt_values <- c(X1 = 50)
# times you want to see your observations
times <- seq(0,52, 1)
# Protocols ----------------------------------
protocols <- list( dose0 = tibble(cmt = "Central", time = 0, amt = 0),
dose50 = tibble(cmt = "Central", time = 0, amt = 50),
dose100 = tibble(cmt = "Central", time = 0, amt = 100)
)
##### Fill the parameter #####
param_reduce<- list(tumVol = c("k2"), Conc = c("Vd", "ke")) #conc1 not here because....
param_increase <- list(tumVol = c("lambda0", "lambda1", "Vd", "ke", "w0" ), Conc = character())
param_no_impact <- list(tumVol = character(), Conc = c("lambda0", "lambda1", "k2", "k1" ))
# Data used -------------------------------------
# data shoud have at least ID, Value and concX columns, X being replace by drug number (one col by drug concentration)
# Avoid any column starting with "conc" if it is not a drug concentration / dose column
data_VT <- read.table("D:/Peccary_Annexe/Exemple_demo/DATA/Simeoni.txt", header = T, sep = ";", na.strings = ".") %>%
mutate(protocol = paste0("dose", Dose), cmt = if_else(YTYPE == 2, "tumVol", "Conc")) %>%
as_tibble %>%
filter(!is.na(cmt))
demo <- VP_proj_creator$new(sourcefile = "D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/test_tutorial/test_tutorial.R")
targets <- tribble(~protocol, ~cmt, ~time, ~min, ~max,
"dose50", "tumVol",  10 , 20, 50,
"dose50", "tumVol",  2 , 10, 20,
"dose100", "Conc",  8 ,  5,  10,
"dose100", "Conc",  0 ,  40, 60)
demo$set_targets(manual = targets )
VP_df <- crossing(k1 = c(0.5),
k2 = seq(0,8,0.2),
ke =   seq(0.6,1.4,0.2),
lambda0 =seq(0,0.16,0.025),
lambda1 = 8:16,
Vd =  20:40,
w0 = 50)
head(VP_df)
demo$add_VP(VP_df, reducefilteratend = F, use_green_filter = T)
demo
VP_df
demo$add_VP(VP_df, reducefilteratend = F, use_green_filter = T)
demo$plot_VP(nmax = 200)
model_RxODE <-  RxODE({
d/dt(Central) <- -ke *  max(Central,0)
Conc <- Central/Vd
tumVol <- X1 + X2 + X3 + X4
growth <- lambda0 *  max(X1,0)/((1 + (lambda0 * max(tumVol,0)/lambda1)^psi)^(1/psi))
X1(0) <- w0
d/dt(X1) <- growth - X1 * max(Conc,0) * k2
d/dt(X2) <- X1 * max(Conc,0) * k2 - k1 * X2
d/dt(X3) <- k1 * (X2 - X3)
d/dt(X4) <- k1 * (X3 - X4)
})
# paremeters value to be used by default (NA if you want to force providing value)
parameters_default_values <- c(psi = 20)
# initial compartment values. At least one, and every missing cmt name would be set to 0
initial_cmt_values <- c(X1 = 50)
# times you want to see your observations
times <- seq(0,52, 1)
# Protocols ----------------------------------
protocols <- list( dose0 = tibble(cmt = "Central", time = 0, amt = 0),
dose50 = tibble(cmt = "Central", time = 0, amt = 50),
dose100 = tibble(cmt = "Central", time = 0, amt = 100)
)
##### Fill the parameter #####
param_reduce<- list(tumVol = c("k2"), Conc = c("Vd", "ke")) #conc1 not here because....
param_increase <- list(tumVol = c("lambda0", "lambda1", "Vd", "ke", "w0" ), Conc = character())
param_no_impact <- list(tumVol = character(), Conc = c("lambda0", "lambda1", "k2", "k1" ))
# Data used -------------------------------------
# data shoud have at least ID, Value and concX columns, X being replace by drug number (one col by drug concentration)
# Avoid any column starting with "conc" if it is not a drug concentration / dose column
data_VT <- read.table("D:/Peccary_Annexe/Exemple_demo/DATA/Simeoni.txt", header = T, sep = ";", na.strings = ".") %>%
mutate(protocol = paste0("dose", Dose), cmt = if_else(YTYPE == 2, "tumVol", "Conc")) %>%
as_tibble %>%
filter(!is.na(cmt))
demo <- VP_proj_creator$new(sourcefile = "D:/these/Second_project/QSP/modeling_work/VT_simeoni/article_QSPVP/test_tutorial/test_tutorial.R")
demo
demo$set_targets(filter = Dose ==50  & cmt == "tumVol",timeforce = c(12,19, 30,45))
VP_df <- crossing(k1 = c(0.5),
k2 = seq(0,8,0.2),
ke =   seq(0.6,1.4,0.2),
lambda0 =seq(0,0.16,0.025),
lambda1 = 8:16,
Vd =  20:40,
w0 = 50)
head(VP_df)
demo$add_VP(VP_df, reducefilteratend = F, use_green_filter = T)
.libPaths()
