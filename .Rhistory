Conc > pk_only$targets$min ~ "Above",
T ~ "Accepted")) %>%
distinct(id, PK)-> PKID
res %>%
filter(time == pd_only$targets$time ) %>%
mutate(PD = case_when(tumVol < pd_only$targets$min ~ "Below",
tumVol > pd_only$targets$max ~ "Above",
T ~ "Accepted")) %>%
distinct(id, PD)-> PDID
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK == "Accepted" & PD != "Accepted" ~ "Rejected\nBy PD",
PK != "Accepted"  ~ "Rejected\nBy PK",
(PK == "Below" & PD == "Above")  ~ "Above and Below",
T ~ "Other")) %>%
# gather("cmt", "value", Conc, tumVol) %>%
filter(time < 5) %>%
ggplot()+
geom_line(aes(time, Conc, group = id, col = PKPD))+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pkplot;pkplot
res %>%
filter(time ==  pk_only$targets$time )
res %>%
filter(time ==  pk_only$targets$time ) %>%
mutate(PK = case_when(Conc < pk_only$targets$min ~ "Below",
Conc > pk_only$targets$max ~ "Above",
T ~ "Accepted")) %>%
distinct(id, PK)-> PKID
res %>%
filter(time == pd_only$targets$time ) %>%
mutate(PD = case_when(tumVol < pd_only$targets$min ~ "Below",
tumVol > pd_only$targets$max ~ "Above",
T ~ "Accepted")) %>%
distinct(id, PD)-> PDID
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK == "Accepted" & PD != "Accepted" ~ "Rejected\nBy PD",
PK != "Accepted"  ~ "Rejected\nBy PK",
(PK == "Below" & PD == "Above")  ~ "Above and Below",
T ~ "Other")) %>%
# gather("cmt", "value", Conc, tumVol) %>%
filter(time < 5) %>%
ggplot()+
geom_line(aes(time, Conc, group = id, col = PKPD))+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pkplot;pkplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "Rejected\nBy PK",
PD != "Accepted"  ~ "Rejected\nBy PD",
(PK == "Below" & PD == "Above")  ~ "Above and Below",
T ~ "Other")) %>%
# gather("cmt", "value", Conc, tumVol) %>%
# filter(time < 5) %>%
ggplot()+
geom_line(aes(time, tumVol, group = id, col = PKPD))+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status")
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "Rejected\nBy PK",
PD != "Accepted"  ~ "Rejected\nBy PD",
(PK == "Below" & PD == "Above")  ~ "Above and Below",
T ~ "Other")) %>%
# gather("cmt", "value", Conc, tumVol) %>%
# filter(time < 5) %>%
ggplot()+
geom_line(aes(time, tumVol, group = id, col = PKPD), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status")
pkplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "Rejected\nBy PK",
PD != "Accepted"  ~ "Rejected\nBy PD",
(PK == "Below" & PD == "Above")  ~ "Above and Below",
T ~ "Other")) %>%
# gather("cmt", "value", Conc, tumVol) %>%
# filter(time < 5) %>%
ggplot()+
geom_line(aes(time, tumVol, group = id, col = PKPD), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
plot_grid(
pkplot,
pdplot,
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 2
)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection"))
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = PKPD), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = PKPD), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected"))+
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red")+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red")+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha =1)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red")+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red")+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red")+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Concentration", col = "Status") -> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free")+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") -> pdplot;pdplot
plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1
)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") -> pdplot;pdplot
plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1
)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = "bottom")-> pdplot;pdplot
plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1
)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = "bottom")-> pdplot;pdplot
pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
# geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = "bottom")-> pdplot;pdplot
plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1
)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+ # just to have legend with alpha1
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = "bottom")-> pdplot;pdplot
plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1
)
plotSeveralYTYPE <- plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1
)
plot_grid(plotSeveralYTYPE, plotSeveralTimepoint)
plot_grid(plotSeveralYTYPE, plotSeveralTimepoint, ncol = 1)
plotSeveralTimepoint <- plot_grid(subplotA, subplotB,subplotD,  subplotC, nrow = 1, labels = LETTERS); plotA
plotSeveralTimepoint
LETTERS[-(1:4)]
plotSeveralYTYPE <- plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T), nrow = 1,labels = LETTERS[-(1:4)]
)
plot_grid(plotSeveralTimepoint , plotSeveralYTYPE,  ncol = 1)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+ # just to have legend with alpha1
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = c(1,0.1))-> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+ # just to have legend with alpha1
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = c(0.1,0.1))-> pdplot;pdplot
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+ # just to have legend with alpha1
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = "Status") +
theme(legend.position = c(0.2,0.1))-> pdplot;pdplot
plotSeveralYTYPE <- plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T)+ ggtitle("PK only"),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T)+ ggtitle("PD only"),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T)+ ggtitle("PK-PD"), nrow = 1,labels = LETTERS[-(1:4)]
)
plot_grid(plotSeveralTimepoint , plotSeveralYTYPE,  ncol = 1)
res %>%
left_join(PKID) %>%
left_join(PDID) %>%
mutate(PKPD = case_when(PK == "Accepted" & PD == "Accepted" ~ "Accepted",
PK != "Accepted" & PD == "Accepted" ~ "PK rejection",
PK == "Accepted" & PD != "Accepted" ~ "PD rejection",
T ~ "both rejection")) %>%
mutate(straightforward = if_else(PK == "Accepted" & PD == "Accepted", "Accepted", "Rejected")) %>%
gather("cmt", "value", Conc, tumVol) %>%
filter(!(time > 5 & cmt == "Conc")) %>%
ggplot()+
geom_line(aes(time, value, group = id, col = straightforward), alpha = 0.3)+
geom_segment(data = pd_only$targets, aes(x = 0, xend = 0, y = 0, yend= 0, col = "Accepted"))+ # just to have legend with alpha1
geom_segment(data = pd_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
geom_segment(data = pk_only$targets, aes(x = time, xend = time, y = min, yend= max), col = "red", size = 2)+
facet_wrap(~cmt, scales = "free", ncol = 1)+
scale_y_log10()+
theme_bw() +
labs(x = "Time", y = "Output of Interest", col = NULL) +
theme(legend.position = c(0.2,0.2))-> pdplot;pdplot
plotSeveralYTYPE <- plot_grid(
pk_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T)+ ggtitle("PK only"),
pd_only$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T)+ ggtitle("PD only"),
pdplot,
pk_pd$plot_2D(x = k2, y = ke, plotoreturn = 1,add_point = T)+ ggtitle("PK-PD"), nrow = 1,labels = LETTERS[-(1:4)]
)
plot_grid(plotSeveralTimepoint , plotSeveralYTYPE,  ncol = 1)
