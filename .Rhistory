PrevLoop == T) PreviousResults <- PreviousResults %>%
filter
PrevLoop
if(PrevLoop == T) PreviousResults <- PreviousResults %>%
filter(id %in% idremoved & protocol == line$protocol [[1]])
tfilterODE <- difftime( Sys.time(), tfilterODE, units = "s")
t02 <- Sys.time()
nref <- nrow(poolVP)
if(time_compteur == T){
t02 <- t02
nref <- nref
}
filters_neg_above_reduc
filters_neg_below_up_reduc
temp <- filters_neg_below_up_reduc %>%
mutate(filtre = map_chr(cmt,  ~ filters[[.x]][["below"]]))
for(a in all_param){
temp %>%
mutate(filtre = map2_chr(filtre, !!parse_expr(a), function(filtre, x){
gsub(paste0("ref\\$", a),x,  filtre)
})) -> temp
}
temp %>%
pull(filtre) -> filtres
filtres
filtre_line <- paste0("(", filtres, ")") %>% paste0(collapse = "|")
filtre_line
poolVP %>% #poolVP_id
mutate(test = !!parse_expr(filtre_line)) %>%
filter(test == T) %>% pull(id) ->idtorem
idtorem
if(saveVPRej == T)    VP_rej <- bind_rows(VP_rej, tibble(id_origin = idtorem) %>% mutate(n = n_compteur))
poolVP
poolVP %>%
filter(! id %in% idtorem)
idtorem
poolVP <- poolVP %>%
filter(! id %in% idtorem)
one <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
one$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
one$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1320) # change seed until two$plot_2D(...) has one squares
one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
one <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
one$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
one$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1320) # change seed until two$plot_2D(...) has one squares
one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
one <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
one$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
one$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1320) # change seed until two$plot_2D(...) has one squares
one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
one <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
one$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
one$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1320) # change seed until two$plot_2D(...) has one squares
one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
one <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
one$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,200)))
one$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1320) # change seed until two$plot_2D(...) has one squares
one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.15,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plotdemo <- self$poolVP %>%
unnest() %>%
mutate(id = paste0("\nk2 = ", k2, "\nlbd0 = ", lambda0, "\n" )) %>%
ggplot()+
geom_line(aes(time, tumVol, group = id, col = factor(id)), size = 2)+
geom_segment(aes(x = 40, xend = 40, y = 50, yend = 200, lty= "Targets"), col = "red", size = 2)+
geom_segment(aes(x = 10, xend = 10, y = 100, yend = 200), col = "red", size = 2)+
theme_bw()+
labs( col= "VPs", lty = "", x = "Time (days)", y = "Tumor volume (mm3)")+
scale_color_manual(values = c("deepskyblue1", "black"))+
scale_y_log10(); plotdemo
self <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
self$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = 12, min = 0, max = 1E5))
self$add_VP(VP_df, fillatend = F, reducefilteratend = F)
self$poolVP %>%
unnest() %>%
ggplot()+
geom_line(aes(time, tumVol, group = id))+
geom_segment(aes(x = 40, xend = 40, y = 50, yend = 200), col = "red", size = 2)+
geom_segment(aes(x = 10, xend = 10, y = 100, yend = 200), col = "red", size = 2)
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.15,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot2 <- two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.15,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot2
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
plotdemo <- self$poolVP %>%
unnest() %>%
mutate(id = paste0("\nk2 = ", k2, "\nlbd0 = ", lambda0, "\n" )) %>%
ggplot()+
geom_line(aes(time, tumVol, group = id, col = factor(id)), size = 2)+
geom_segment(aes(x = 40, xend = 40, y = 50, yend = 200, lty= "Targets"), col = "red", size = 2)+
geom_segment(aes(x = 10, xend = 10, y = 100, yend = 200), col = "red", size = 2)+
theme_bw()+
labs( col= "VPs", lty = "", x = "Time (days)", y = "Tumor volume (mm3)")+
scale_color_manual(values = c("deepskyblue1", "black"))+
scale_y_log10(); plotdemo
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
one <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
one$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,60)))
one$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1320) # change seed until two$plot_2D(...) has one squares
one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
two <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
two$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,60)))
two$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 1, keepRedFiltaftDis = T)
set.seed(1322) # change seed until two$plot_2D(...) has two squares
two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.15,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot2 <- two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.15,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot2
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
plotdemo <- self$poolVP %>%
unnest() %>%
mutate(id = paste0("\nk2 = ", k2, "\nlbd0 = ", lambda0, "\n" )) %>%
ggplot()+
geom_line(aes(time, tumVol, group = id, col = factor(id)), size = 2)+
geom_segment(aes(x = 40, xend = 40, y = 50, yend = 80, lty= "Targets"), col = "red", size = 2)+
geom_segment(aes(x = 10, xend = 10, y = 100, yend = 200), col = "red", size = 2)+
theme_bw()+
labs( col= "VPs", lty = "", x = "Time (days)", y = "Tumor volume (mm3)")+
scale_color_manual(values = c("deepskyblue1", "black"))+
scale_y_log10(); plotdemo
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.75,0.25,0.75), y = c(0.025,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.75,0.25,0.75), y = c(0.075,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.25,0.75), y = c(0.075,0.025,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.075), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 3, 2)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot2 <- two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)), aes(x=x, y = y, label = label), size = 8)+  geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot2
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If blue profile sampled"),
nrow =1, labels = LETTERS
)
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If blue profile sampled"),
plot2+ ggtitle("If black profile sampled"),
nrow =1, labels = LETTERS
)
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025) %>% slice(1:2), label = c(1, 2, 3)), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot1 <- one$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)) %>% slice(1:2), aes(x=x, y = y, label = label), size = 8)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot1
plot2 <- two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)) %>% slice(3), aes(x=x, y = y, label = label), size = 8)+  geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot2
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If blue profile sampled"),
plot2+ ggtitle("If black profile sampled"),
nrow =1, labels = LETTERS
)
all <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
all$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,60)))
all$add_VP(VP_df, fillatend = F, reducefilteratend = F, npersalve = 2, keepRedFiltaftDis = T)
all$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
all <- VP_proj_creator$new()
VP_df <- tibble(k1 = c(0.5),
k2 = c(0.5,1),
ke = 1 ,#*  seq(0.6,1.4,0.2),
lambda0 = c(0.1,0.05),
lambda1 = c(12),
w0 = 50,
Vd =  40)
all$set_targets(manual = tibble(protocol = "dose50", cmt = "tumVol", time = c(10,40), min = c(100,50), max = c(200,60)))
all$add_VP(VP_df, fillatend = F, reducefilteratend = T, npersalve = 2, keepRedFiltaftDis = T)
all$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T)
plot3 <-  all$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)) %>% slice(3), aes(x=x, y = y, label = label), size = 8)+  geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot3
plot3 <-  all$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
# geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)) %>% slice(3), aes(x=x, y = y, label = label), size = 8)+  geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot3
cowplot::plot_grid(
plotdemo
,
plot1+ ggtitle("If blue profile sampled"),
plot2+ ggtitle("If black profile sampled"),
plot2+ ggtitle("If both profile sampled"),
nrow =2, labels = LETTERS
)
cowplot::plot_grid(
plotdemo
,
plot3+ ggtitle("If both profile sampled"),
plot1+ ggtitle("If blue profile sampled"),
plot2+ ggtitle("If black profile sampled")
nrow =2, labels = LETTERS
)
cowplot::plot_grid(
plotdemo
,
plot3+ ggtitle("If both profile sampled"),
plot1+ ggtitle("If blue profile sampled"),
plot2+ ggtitle("If black profile sampled"),
nrow =2, labels = LETTERS
)
cowplot::plot_grid(
plotdemo
,
plot3+ ggtitle("If both profiles sampled"),
plot1+ ggtitle("If blue profile sampled"),
plot2+ ggtitle("If black profile sampled"),
nrow =2, labels = LETTERS
)
cowplot::plot_grid(
plotdemo
,
plot3+ ggtitle("If both profiles sampled"),
plot1+ ggtitle("If blue profile sampled only"),
plot2+ ggtitle("If black profile sampled only"),
nrow =2, labels = LETTERS
)
plot2 <- two$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)) %>% slice(3), aes(x=x, y = y, label = label), size = 8)+  geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot2
plot3 <-  all$plot_2D(x = k2, y = lambda0, plotoreturn = 1,add_point = T) +
geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
# geom_text(data = tibble( x = c(0.25,0.75,0.75), y = c(0.075,0.15,0.025), label = c(1, 2, 3)) %>% slice(3), aes(x=x, y = y, label = label), size = 8)+  geom_hline(data =  self$poolVP, aes(yintercept = lambda0), lty=2)+
geom_vline(data =  self$poolVP, aes(xintercept = k2), lty=2)+
geom_point(data =  self$poolVP %>% filter(id == 1) , aes(k2, lambda0), col = "deepskyblue1", size = 2)+
geom_point(data =  self$poolVP %>% filter(id == 2) , aes(k2, lambda0), col = "black", size = 2)+
coord_cartesian(ylim = c(0,0.2), xlim = c(0,1.5)); plot3
cowplot::plot_grid(
plotdemo
,
plot3+ ggtitle("If both profiles sampled"),
plot1+ ggtitle("If blue profile sampled only"),
plot2+ ggtitle("If black profile sampled only"),
nrow =2, labels = LETTERS
)
