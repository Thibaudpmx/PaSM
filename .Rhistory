filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", filterone,")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
filterone
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", c(filterone,filterone,filterone),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
c(filterone,filterone,filterone)
filters_neg_above_reduc
filterone
rep(filterone,10)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", rep(filterone,10),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", rep(filterone,10),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", rep(filterone,10),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
rep(filterone,10)
poolVP2
timetoanaloop %>%
select(nremoved_above_fil, filter_neg_above, remneg_above_fil, nfilter_negab_bef,nfilters_negab_af )
rep(filterone,3)
poolVP2 <- poolVP
t0 <- Sys.time()
filters_neg_above_reduc %>%
mutate(filter = filters[["above"]]) %>%
mutate(filter = map2_chr(ke, filter,  ~ gsub("ref\\$ke", .x, .y))) %>%
mutate(filter = map2_chr(k1, filter,  ~ gsub("ref\\$k1", .x, .y))) %>%
mutate(filter = map2_chr( k2, filter,  ~ gsub("ref\\$k2", .x, .y))) %>%
mutate(filter = map2_chr( lambda0, filter,  ~ gsub("ref\\$lambda0", .x, .y))) %>%
mutate(filter = map2_chr( lambda1, filter,  ~ gsub("ref\\$lambda1", .x, .y))) %>%
mutate(filter = map2_chr( Vd, filter,  ~ gsub("ref\\$Vd", .x, .y))) %>%
pull(filter) -> filterone
uniquefilter <- paste0("(", rep(filterone,3),")") %>% paste0(collapse = "|")
poolVP2 <- poolVP2 %>%
mutate(test = !!parse_expr(uniquefilter)) %>%
filter(test == F)
difftime(Sys.time(), t0)
timetoanaloop %>%
select(nremoved_above_fil, filter_neg_above, remneg_above_fil, nfilter_negab_bef,nfilters_negab_af )
timetoanaloop %>%
select(timemodel, nremoved_above_fil, filter_neg_above, remneg_above_fil, nfilter_negab_bef,nfilters_negab_af )
timetoanaloop %>%
select(timemodel, nremoved_above_fil, filter_neg_above, remneg_above_fil, nfilter_negab_bef,nfilters_negab_af ) %>%
mutate(timesaved = nremoved_above_fil * timemodel / 2000)
source("D:/these/Second_project/QSP/QSPVP/R/R6object.R")
self <- VP_proj_creator$new()
# self$set_targets(filter = Dose == 50 & cmt == "tumVol", ntime = 8)
self$set_targets(filter = Dose == 50 & cmt == "tumVol",timeforce = c(12,19, 30,45))
VP_df <- crossing(k1 = c(0.5),
k2 = seq(0,8,0.2),
ke = seq(0.2,2,0.2) ,#*  seq(0.6,1.4,0.2),
lambda0 =seq(0,0.16,0.02),
lambda1 = seq(10,14,2),
Vd =  c(20:40)) %>% #c(0.8,1,1.2)) %>%
map_df(function(x){
if(is.character(x)) return(x)
round(x,3)
} )
t0 <- Sys.time()
self$add_VP(VP_df, fillatend = F, reducefilteratend = F, testnofV = T, npersalve = 2000, time_compteur = T)
Sys.time() - t0
VP_df
timetoanaloop %>%
select(timemodel, nremoved_above_fil, filter_neg_above, remneg_above_fil, nfilter_negab_bef,nfilters_negab_af ) %>%
mutate(timesaved = nremoved_above_fil * timemodel / 2000)
0.35 * 232 / 2
timetoanaloop %>%
select(timemodel, nremoved_below_fil, filter_neg_below, remneg_below_fil, nfilter_negbe_bef,nfilters_negbe_af ) %>%
mutate(timesaved = nremoved_below_fil * timemodel / 2000)
timetoanaloop %>%
select(timemodel, nremoved_below_fil, filter_neg_below, remneg_below_fil, nfilter_negbel_bef,nfilters_negbel_af ) %>%
mutate(timesaved = nremoved_below_fil * timemodel / 2000)
